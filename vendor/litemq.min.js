var LiteMQ={debugMode:!1,utils:{convertToArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)?t:[t]}},log:function(t){"undefined"!=typeof console&&console.log&&console.log(t)},debug:function(t,e){this.debugMode&&(this.log(["# DEBUG MODE ON","# Bus: "+t.bus.name,"# Origin: "+t.name,"# Event: "+e.eventName,"# Body: "].join("\n")),this.log(e.body),this.log("#########################"))}};LiteMQ.Bus=o.Class({attach:function(t,e,n){for(var i=LiteMQ.utils.convertToArray(t),s=0;i.length>s;s++)this._addEventListener(i[s],[e,n])},detach:function(t,e,n){var i;if(t){i=LiteMQ.utils.convertToArray(t);for(var s=0;i.length>s;s++)n?this._detachListener(i[s],e,n):this._detachEvent(i[s],e)}else this._detachAll(e)},init:function(t){this._super(t),this._listeners={}},trigger:function(t,e,n){for(var i=LiteMQ.utils.convertToArray(t),s=0;i.length>s;s++)n.eventName=i[s],LiteMQ.debug(e,n),this._filterEventListener(i[s],function(t,i){try{return t!==e&&i.call(t,n),!0}catch(s){console.log(s)}})},_addEventListener:function(t,e){var n=this._getEventListeners(t);n.push(e)},_detachAll:function(t){var e=this._getListeners();for(var n in e)this._detachEvent(n,t)},_detachEvent:function(t,e){this._filterEventListener(t,function(t){return e!==t?!0:void 0})},_detachListener:function(t,e,n){this._filterEventListener(t,function(t,i){return e!==t||n!==i?!0:void 0})},_filterEventListener:function(t,e){for(var n,i=this._getEventListeners(t),s=[],r=0;i.length>r;r++)n=i[r],e(n[0],n[1])&&s.push([n[0],n[1]]);this._setEventListeners(t,s)},_getEventListeners:function(t){var e=this._listeners[t]||[];return this._setEventListeners(t,e),this._listeners[t]},_getListeners:function(){return this._listeners},_setEventListeners:function(t,e){this._listeners[t]=e}}),LiteMQ.DefaultBus=new LiteMQ.Bus({name:"DefaultBus"}),LiteMQ.Client=o.Class({init:function(t){this.bus=LiteMQ.DefaultBus,this.name="anonymous",this._super(t)},pub:function(t,e){var n={};return"object"==typeof e&&(e=JSON.parse(JSON.stringify(e))),n.origin=this.name,n.body=e,this.bus.trigger(t,this,n),this},sub:function(t,e){return this.bus.attach(t,this,e),this},unsub:function(t,e){return this.bus.detach(t,this,e),this}});